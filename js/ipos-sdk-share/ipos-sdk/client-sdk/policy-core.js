/*
 * //*******************************************************************************
 * // * Copyright (c) 2011-2014 CSC.
 * // * Copyright (C) 2010-2016 CSC - All rights reserved.
 * // *
 * // * The information contained in this document is the exclusive property of
 * // * CSC.  This work is protected under USA copyright law
 * // * and the copyright laws of given countries of origin and international
 * // * laws, treaties and/or conventions. No part of this document may be
 * // * reproduced or transmitted in any form or by any means, electronic or
 * // * mechanical including photocopying or by any informational storage or
 * // * retrieval system, unless as expressly permitted by CSC.
 * //
 * // * Design, Develop and Manage by Team Integral Point-of-Sales & Services
 * // ******************************************************************************
 */

'use strict';
var policyModule = angular.module('policyModule',['coreModule'])
.service('policyCoreService', ['$q', 'ajax', '$location', 'appService', 'cacheService', 'detailCoreService', 'commonService', 'commonUIService', 'clientCoreService', 'translateService', '$translate', 'salecaseUIService', 'connectService',
    function($q, ajax, $location, appService, cacheService, detailCoreService, commonService, commonUIService, clientCoreService, translateService, $translate, salecaseUIService, connectService){
	
	function PolicyCoreService($q, ajax, $location, appService, cacheService, detailCoreService, commonService, clientCoreService, translateService, $translate, salecaseUIService, connectService){
		var self = this;
		this.detailCoreService = detailCoreService;
		detailCoreService.ListDetailCoreService.call(self, $q, ajax, $location, appService, cacheService, commonService);
	//	this.name = commonService.CONSTANTS.MODULE_NAME.HOME;
	//	self.init();
	};
	inherit(detailCoreService.ListDetailCoreService, PolicyCoreService);
	
	//old get policy list with 
	PolicyCoreService.prototype.loadList = function(resourceURL){
		 var self = this;
		 var deferred = self.$q.defer();
		 var url = commonService.getUrl(commonService.urlMap.SERVICE_FIND_DOCUMENTLIST_CURRENT_AGENT_V3, ['policies']);
		 self.ajax.getRuntime(resourceURL, url, function(data){
			 deferred.resolve(data);						
		 });
		 return  deferred.promise;
	 };
	 
	//old get policy list with 
	PolicyCoreService.prototype.getClientList = function(resourceURL){
		 var self = this;
		 var deferred = self.$q.defer();
		 var url = commonService.getUrl(commonService.urlMap.CLIENT_LIST_V3, []);		
		 self.ajax.getRuntime(resourceURL, url, function(data){
			 deferred.resolve(data);						
		 });
		 return  deferred.promise;
	 };
	 
	 //old getlist
	PolicyCoreService.prototype.loadListOfClient = function(resourceURL,clientId){
		 var self = this;
		 var deferred = self.$q.defer();
		 var url = "";
		 if (clientId == undefined || clientId == null || clientId == "") {
			 url = commonService.getUrl(commonService.urlMap.SERVICE_FIND_DOCUMENTLIST_CURRENT_CLIENT_V3, ['policies']);
		 } else {
			 url = commonService.getUrl(commonService.urlMap.SERVICE_FIND_DOCUMENTLIST_CLIENT_V3, ['policies',clientId]);
		 }
		 self.ajax.getRuntime(resourceURL, url, function(data){
			 deferred.resolve(data);						
		 });
		 return  deferred.promise;
	 };
	 
	 //get list policy with agentid new for new UI
	 PolicyCoreService.prototype.getDocumentList_V3 = function(resourceURL){
		 var self = this;
		 var deferred = self.$q.defer();
		 //var mockData = {"Policy":{"Policy":[{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"motor","Status":"Review Required","Total_Premium":"15000","Contract_Number":"F0000056","Contract_Type":"motor_private_car_m_as"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141109","Policy_Owner":"fire","Status":"Review Required","Total_Premium":"8000","Contract_Number":"F0000057","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"15000","Contract_Number":"A0000032","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141109","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"A0000033","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20141125","Inception_Date":"20131126","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"9000","Contract_Number":"F0000048","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151125","Inception_Date":"20141125","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"9000","Contract_Number":"F0000047","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20141125","Inception_Date":"20131126","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"17000","Contract_Number":"F0000046","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20141125","Inception_Date":"20131126","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"8000","Contract_Number":"F0000053","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1500","Contract_Number":"F0000038","Contract_Type":"fire"},{"Agent_ID":"10000002","Client_Number":"50000001","Expiry_Date":"20150801","Inception_Date":"20140802","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"3000","Contract_Number":"F0000004","Contract_Type":"fire"},{"Agent_ID":"10000002","Client_Number":"50000001","Expiry_Date":"20151014","Inception_Date":"20141015","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1000","Contract_Number":"F0000003","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151125","Inception_Date":"20141126","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"A0000036","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151117","Inception_Date":"20141118","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1500","Contract_Number":"F0000039","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"15000","Contract_Number":"A0000034","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20141225","Inception_Date":"20131226","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"137.25","Contract_Number":"V0000088","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"6000","Contract_Number":"W0000011","Contract_Type":"Workmen's Compensation"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131125","Inception_Date":"20121126","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"15000","Contract_Number":"A0000037","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131125","Inception_Date":"20121126","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"1896.24","Contract_Number":"V0000069","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131125","Inception_Date":"20121126","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"9000","Contract_Number":"F0000052","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20160114","Inception_Date":"20150115","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"3070706.85","Contract_Number":"V0000121","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151114","Inception_Date":"20141115","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"392.5","Contract_Number":"A0000018","Contract_Type":"Personal Accident - Individual"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"A0000020","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141109","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"","Contract_Number":"A0000022","Contract_Type":"Travel Accident - Thai(Tariff)"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141109","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"A0000035","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"167.5","Contract_Number":"A0000046","Contract_Type":"Personal Accident - Individual"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141109","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"15000","Contract_Number":"C0000006","Contract_Type":"MARINE CARGO"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"F0000033","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"F0000035","Contract_Type":"fire"},{"Agent_ID":"10000006","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"5000","Contract_Number":"H0000008","Contract_Type":"Marine Hull"},{"Agent_ID":"10000006","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1878.01","Contract_Number":"V0000042","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000006","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1878.01","Contract_Number":"V0000043","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"6000","Contract_Number":"W0000010","Contract_Type":"Workmen's Compensation"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131225","Inception_Date":"20121226","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"151.61","Contract_Number":"V0000089","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131125","Inception_Date":"20121126","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"12000","Contract_Number":"A0000038","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20141014","Inception_Date":"20131015","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"392.5","Contract_Number":"A0000003","Contract_Type":"Personal Accident - Individual"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131125","Inception_Date":"20121126","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"9600","Contract_Number":"F0000054","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"Cancelled Policy","Total_Premium":"3070706.85","Contract_Number":"V0000152","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20160114","Inception_Date":"20150115","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"3070706.85","Contract_Number":"V0000115","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20160114","Inception_Date":"20150115","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"3070706.85","Contract_Number":"V0000157","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151125","Inception_Date":"20141126","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1896.24","Contract_Number":"V0000070","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151209","Inception_Date":"20141210","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"8655555555555.55","Contract_Number":"F0000072","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20160114","Inception_Date":"20150115","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1000000","Contract_Number":"A0000059","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20160114","Inception_Date":"20150114","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1000000","Contract_Number":"C0000017","Contract_Type":"MARINE CARGO"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151009","Inception_Date":"20141010","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"12000","Contract_Number":"F0000073","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"3070706.85","Contract_Number":"V0000151","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"Pending New Business","Total_Premium":"3070706.85","Contract_Number":"V0000153","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150209","Inception_Date":"20140210","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"1000000","Contract_Number":"C0000021","Contract_Type":"MARINE CARGO"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150209","Inception_Date":"20140210","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"90000","Contract_Number":"F0000101","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150209","Inception_Date":"20140210","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"1000000","Contract_Number":"A0000063","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150114","Inception_Date":"20140115","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"3070706.85","Contract_Number":"V0000155","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"Pending New Business","Total_Premium":"3070706.85","Contract_Number":"V0000147","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"3070706.85","Contract_Number":"V0000145","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"3070706.85","Contract_Number":"V0000146","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"Pending New Business","Total_Premium":"3070706.85","Contract_Number":"V0000150","Contract_Type":"Private Fleet"}]}};
			
		 var url = commonService.getUrl(commonService.urlMap.SERVICE_FIND_DOCUMENTLIST_CURRENT_AGENT_V3, ['policies']);		
		 self.ajax.getRuntime(resourceURL, url, function(data){
			 //mock data list
			 
			//if got respeonse data
			 if(data.Policy){
				 self.items = data;
			 }
			 else{
				 commonUIService.showNotifyMessage("v3.style.message.errorGettingPolicyList", "fail");
				/* self.items = mockData;*/
			 }
			 // self.items = data;
			 deferred.resolve(data);						
		 });
		 return  deferred.promise;
	 };
	 
	 //get list policy with agentid new for new UI
	 PolicyCoreService.prototype.getClaimHistoryList = function(resourceURL){
		 var self = this;
		 var deferred = self.$q.defer();
		 //var mockData = {"Policy":{"Policy":[{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"motor","Status":"Review Required","Total_Premium":"15000","Contract_Number":"F0000056","Contract_Type":"motor_private_car_m_as"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141109","Policy_Owner":"fire","Status":"Review Required","Total_Premium":"8000","Contract_Number":"F0000057","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"15000","Contract_Number":"A0000032","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141109","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"A0000033","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20141125","Inception_Date":"20131126","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"9000","Contract_Number":"F0000048","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151125","Inception_Date":"20141125","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"9000","Contract_Number":"F0000047","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20141125","Inception_Date":"20131126","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"17000","Contract_Number":"F0000046","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20141125","Inception_Date":"20131126","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"8000","Contract_Number":"F0000053","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1500","Contract_Number":"F0000038","Contract_Type":"fire"},{"Agent_ID":"10000002","Client_Number":"50000001","Expiry_Date":"20150801","Inception_Date":"20140802","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"3000","Contract_Number":"F0000004","Contract_Type":"fire"},{"Agent_ID":"10000002","Client_Number":"50000001","Expiry_Date":"20151014","Inception_Date":"20141015","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1000","Contract_Number":"F0000003","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151125","Inception_Date":"20141126","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"A0000036","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151117","Inception_Date":"20141118","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1500","Contract_Number":"F0000039","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"15000","Contract_Number":"A0000034","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20141225","Inception_Date":"20131226","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"137.25","Contract_Number":"V0000088","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"6000","Contract_Number":"W0000011","Contract_Type":"Workmen's Compensation"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131125","Inception_Date":"20121126","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"15000","Contract_Number":"A0000037","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131125","Inception_Date":"20121126","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"1896.24","Contract_Number":"V0000069","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131125","Inception_Date":"20121126","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"9000","Contract_Number":"F0000052","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20160114","Inception_Date":"20150115","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"3070706.85","Contract_Number":"V0000121","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151114","Inception_Date":"20141115","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"392.5","Contract_Number":"A0000018","Contract_Type":"Personal Accident - Individual"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"A0000020","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141109","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"","Contract_Number":"A0000022","Contract_Type":"Travel Accident - Thai(Tariff)"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141109","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"A0000035","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"167.5","Contract_Number":"A0000046","Contract_Type":"Personal Accident - Individual"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141109","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"15000","Contract_Number":"C0000006","Contract_Type":"MARINE CARGO"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"F0000033","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"10000","Contract_Number":"F0000035","Contract_Type":"fire"},{"Agent_ID":"10000006","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"5000","Contract_Number":"H0000008","Contract_Type":"Marine Hull"},{"Agent_ID":"10000006","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1878.01","Contract_Number":"V0000042","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000006","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1878.01","Contract_Number":"V0000043","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151109","Inception_Date":"20141110","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"6000","Contract_Number":"W0000010","Contract_Type":"Workmen's Compensation"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131225","Inception_Date":"20121226","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"151.61","Contract_Number":"V0000089","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131125","Inception_Date":"20121126","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"12000","Contract_Number":"A0000038","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20141014","Inception_Date":"20131015","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"392.5","Contract_Number":"A0000003","Contract_Type":"Personal Accident - Individual"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20131125","Inception_Date":"20121126","Policy_Owner":"JONES HARRY","Status":"Pending Endorsement","Total_Premium":"9600","Contract_Number":"F0000054","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"Cancelled Policy","Total_Premium":"3070706.85","Contract_Number":"V0000152","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20160114","Inception_Date":"20150115","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"3070706.85","Contract_Number":"V0000115","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20160114","Inception_Date":"20150115","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"3070706.85","Contract_Number":"V0000157","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151125","Inception_Date":"20141126","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1896.24","Contract_Number":"V0000070","Contract_Type":"Private Vehicle M"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151209","Inception_Date":"20141210","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"8655555555555.55","Contract_Number":"F0000072","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20160114","Inception_Date":"20150115","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1000000","Contract_Number":"A0000059","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20160114","Inception_Date":"20150114","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"1000000","Contract_Number":"C0000017","Contract_Type":"MARINE CARGO"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20151009","Inception_Date":"20141010","Policy_Owner":"JONES HARRY","Status":"Review Required","Total_Premium":"12000","Contract_Number":"F0000073","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"3070706.85","Contract_Number":"V0000151","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"Pending New Business","Total_Premium":"3070706.85","Contract_Number":"V0000153","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150209","Inception_Date":"20140210","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"1000000","Contract_Number":"C0000021","Contract_Type":"MARINE CARGO"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150209","Inception_Date":"20140210","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"90000","Contract_Number":"F0000101","Contract_Type":"fire"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150209","Inception_Date":"20140210","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"1000000","Contract_Number":"A0000063","Contract_Type":"All Risks"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150114","Inception_Date":"20140115","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"3070706.85","Contract_Number":"V0000155","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"Pending New Business","Total_Premium":"3070706.85","Contract_Number":"V0000147","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"3070706.85","Contract_Number":"V0000145","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"In Force","Total_Premium":"3070706.85","Contract_Number":"V0000146","Contract_Type":"Private Fleet"},{"Agent_ID":"10000001","Client_Number":"50000001","Expiry_Date":"20150214","Inception_Date":"20140215","Policy_Owner":"JONES HARRY","Status":"Pending New Business","Total_Premium":"3070706.85","Contract_Number":"V0000150","Contract_Type":"Private Fleet"}]}};
		 var policyNumber = self.findElementInDetail_V3(['policy:DocumentRelation', 'policy:PolicyNo']).$;
		 var url = commonService.getUrl(commonService.urlMap.SERVICE_FIND_CLAIM_HISTORY_LIST_V3, [policyNumber]);		
		 self.ajax.getRuntime(resourceURL, url, function(data){
			 //mock data list
			 
			//if got respeonse data
			 /*if(!data.getClaimListResponse){
				 commonUIService.showNotifyMessage("v3.style.message.errorGettingClaimList", "fail");
				 return $q.reject();
				 self.items = mockData;
			 }*/
			 // self.items = data;
			 deferred.resolve(data);	 					
		 });
		 return  deferred.promise;
	 };
	 
	 
	 //old get document detail
	 PolicyCoreService.prototype.loadPolicyDetail = function(resourceURL,policyId){
		 var self = this;
		 var deferred = self.$q.defer();
		 var url = commonService.getUrl(commonService.urlMap.GET_POLICY_DETAIL, [ policyId ]);		
		 self.ajax.getRuntime(resourceURL, url, function(data){
			 deferred.resolve(data);						
		 });
		 return  deferred.promise;
	 };
	 
	 //get policy detail for new UI (currently used from Sept 2015)
	 PolicyCoreService.prototype.getDocumentDetailByPolicyNo_V3 = function(resourceURL, policyId, policyType, effectiveDate){
		 var self = this;
		 var deferred = self.$q.defer();
		 
		 /*var urlMap = commonService.urlMap.GET_POLICY_DETAIL;
		 if(policyType == "Private Vehicle M") {
			 policyType = "VPM";
		 }
		 var url = commonService.getUrl(urlMap, [ policyId , policyType, effectiveDate]);		
		 self.ajax.getRuntime(resourceURL, url, function(data){
			 if (self.isSuccess(data)){
				 deferred.resolve(data);
				 self.detail = data;
			 }
		 });*/
		 
		 if(policyType == "Private Vehicle M") {
			 policyType = "VPM";
		 }
		 connectService.exeAction({
	    	actionName: "GET_POLICY_DETAIL",
	    	actionParams: [policyId, policyType, effectiveDate],
	    	resourceURL: resourceURL
		 }).then(function(data){
			 if(self.isSuccess(data)){
				 self.detail = data;
				 deferred.resolve(data);
			 } else { 
				 deferred.resolve(data);
			 }
		 });		 
		 return  deferred.promise;
	 };
	 
	 PolicyCoreService.prototype.getPolicyDetailFinal_V3 = function(resourceURL, policyId){
		 var self = this;
		 var deferred = self.$q.defer();
		 //mock policy id
		/* policyId = "V0001350";*/
		 //commonService.urlMap.GET_POLICY_DETAIL
		 var urlMap = commonService.urlMap.DOCUMENT_FIND_DOCUMENT_API_V3_NO_VERSION;
		 
		  
		 var url = commonService.getUrl(urlMap, [ policyId ]);		
		 self.ajax.getRuntime(resourceURL, url, function(data){
			 if (data['ipos-response:response']==undefined){
				 self.detail = data;
				 self.jsonToArray( self.findElementInDetail_V3(['policy:PolicyOwner']), 'person:IDs' , 'person:ID');
				 self.jsonToArray( self.findElementInDetail_V3(['policy:MainDriver']),  'person:IDs' , 'person:ID');
				 self.jsonToArray( self.detail,  'policy:OptionalCoverages' , 'policy:OptionalCoverage');
				 
				 
				 self.POIDs = self.findElementInDetail_V3(['policy:PolicyOwner', 'person:ID']);
				 //self.MDIDs = self.findElementInDetail_V3(['policy:MainDriver', 'person:ID']);
				 
				 self.POContacts = self.findElementInDetail_V3(['policy:PolicyOwner','person:Contact']);
				 self.AdditionalCoverages = self.findElementInDetail_V3(['policy:OptionalCoverages','policy:OptionalCoverage']);
			 }
			 else {//delete later
				 data ={"IposDocument":{"@xmlns":"http://www.csc.com/integral/common","@xmlns:policy-fire":"http://www.csc.com/integral/policy-fire","@xmlns:person":"http://www.csc.com/integral/personal","@xmlns:motor":"http://www.csc.com/integral/motor","Header":{"DocInfo":{"DocType":"policy","Product":"FIR","DefUid":"","DocId":"","DocName":"","DocVersion":"","OwnerUid":"","CreatedDate":"","UpdatedDate":"","UpdatedUserUid":"","Tags":"","Star":"","Archived":"","Comments":""},"DocAccessControllList":{"User":{"@userid":"","Permisions":{"Permision":""}}},"DocStatus":{"DocumentStatus":"","BusinessStatus":"IF"}},"Data":{"policy-fire:Policy":{"@xmlns:policy-fire":"http://www.csc.com/integral/policy-fire","@vpms-suffix":"Policy","policy-fire:DocumentRelation":{"@vpms-suffix":"DocumentRelation","policy-fire:ActionType":{"@vpms-suffix":"ActionType"},"policy-fire:EndorsementReason":{"@vpms-suffix":"EndorsementReason"},"policy-fire:EndorsementReasonNote":{"@vpms-suffix":"EndorsementReasonNote"},"policy-fire:ClientId":{"@vpms-suffix":"ClientId","$":"0002147"},"policy-fire:PolicyNo":{"@vpms-suffix":"PolicyNo","$":"V0001514"},"policy-fire:CaseId":{"@vpms-suffix":"CaseId"}},"policy-fire:PolicyOwner":{"@vpms-suffix":"POPersonal","person:Photo":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POPhoto"},"person:Title":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POTitle","Options":{"Option":""},"Value":"MS"},"person:PersonName":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POPersonName","person:FirstName":{"@vpms-suffix":"POFirstName"},"person:MiddleName":{"@vpms-suffix":"POMiddleName"},"person:LastName":{"@vpms-suffix":"POLastName"},"person:AliasName":{"@vpms-suffix":"POAliasName"},"person:FullName":{"@vpms-suffix":"POFullName","$":"Tong Anh Eleven"}},"person:BirthDate":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POBirthDate","$":"1971-01-01"},"person:Gender":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POGender","Options":{"Option":""},"Value":"F"},"person:MaritalStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POMaritalStatus","Options":{"Option":""},"Value":"M"},"person:SmokerStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POSmokerStatus","Options":{"Option":""},"Value":""},"person:BusinessIndustry":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POBusinessIndustry","Options":{"Option":""},"Value":""},"person:Occupation":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POOccupation","Options":{"Option":""},"Value":"ACCT"},"person:ReferralType":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POReferralType","Options":{"Option":""},"Value":""},"person:Referrer":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POReferrer"},"person:Race":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"PORace","Options":{"Option":""},"Value":""},"person:Nationality":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"PONationality","Options":{"Option":""},"Value":"SGP"},"person:IDs":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POIDs","@counter":"1","person:ID":{"@vpms-suffix":"POID","person:IDType":{"@vpms-suffix":"POIDType","Options":{"Option":""},"Value":"PP"},"person:IDNumber":{"@vpms-suffix":"POIDNumber","$":"S8978575H"}}},"person:Staff":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POStaff","Options":{"Option":""},"Value":""},"person:Vip":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POVip","Options":{"Option":""},"Value":"N"},"person:Education":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POEducation","Options":{"Option":""},"Value":""},"person:EmploymentStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POEmploymentStatus","Options":{"Option":""},"Value":""},"person:CountryOfBirth":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POCountryOfBirth","Options":{"Option":""},"Value":""},"person:Age":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POAge"},"person:Addresses":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POAddresses","@counter":"1","person:Address":{"@vpms-suffix":"POAddress","person:AddressType":{"@vpms-suffix":"POAddressType","Options":{"Option":""},"Value":"RESIDENTIAL"},"person:BlkHouseNo":{"@vpms-suffix":"POBlkHouseNo"},"person:Street":{"@vpms-suffix":"POStreet","$":"11/15 Cong Hoa"},"person:UnitNo":{"@vpms-suffix":"POUnitNo","$":"Floor 5"},"person:Building":{"@vpms-suffix":"POBuilding","$":"Etown 3"},"person:City":{"@vpms-suffix":"POCity","$":"Ho Chi Minh"},"person:Country":{"@vpms-suffix":"POCountry","Options":{"Option":""},"Value":"SGP"},"person:Postal":{"@vpms-suffix":"POPostal","$":"T5S678"},"person:PreferredAddress":{"@vpms-suffix":"POPreferredAddress","Options":{"Option":""},"Value":""}}},"person:Contacts":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"POContacts","@counter":"1","person:Contact":{"@vpms-suffix":"POContact","person:ContactType":{"@vpms-suffix":"POContactType","Options":{"Option":""},"Value":"EMAIL_ADDRESS"},"person:ContactInformation":{"@vpms-suffix":"POContactInformation","$":"atong11@ipos.com"},"person:PreferredContact":{"@vpms-suffix":"POPreferredContact","Options":{"Option":""},"Value":""}}},"policy-fire:POYearDrivingLicenceObtained":{"@vpms-suffix":"POYearDrivingLicenceObtained"}},"policy-fire:CorrespondenceAddress":{"@vpms-suffix":"CorrespondenceAddress","person:AddressType":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"CAddressType","Options":{"Option":""},"Value":"CORRESPONDENCE"},"person:BlkHouseNo":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"CBlkHouseNo","$":"11/15"},"person:Street":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"CStreet","$":"Cong Hoa"},"person:UnitNo":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"CUnitNo","$":"Floor 5"},"person:Building":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"CBuilding","$":"Etown 3"},"person:City":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"CCity","$":"Ho Chi Minh"},"person:Country":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"CCountry","Options":{"Option":""},"Value":"SGP"},"person:Postal":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"CPostal","$":"T5S678"},"person:PreferredAddress":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"CPreferredAddress","Options":{"Option":""},"Value":""}},"policy-fire:ProductDetails":{"@vpms-suffix":"ProductDetails","policy-fire:BasicInformation":{"@vpms-suffix":"BasicInformation","policy-fire:InceptionDate":{"@vpms-suffix":"InceptionDate","$":"2013-01-13"},"policy-fire:ExpiryDate":{"@vpms-suffix":"ExpiryDate","$":"2015-11-16"},"policy-fire:IssueDate":{"@vpms-suffix":"IssueDate","$":"2013-01-13"},"policy-fire:EffectiveDate":{"@vpms-suffix":"EffectiveDate"},"policy-fire:BillingCurrency":{"@vpms-suffix":"BillingCurrency","Options":{"Option":""},"Value":"SGD"},"policy-fire:SICurrency":{"@vpms-suffix":"SICurrency","Options":{"Option":""},"Value":"SGD"},"policy-fire:DocumentType":{"@vpms-suffix":"DocumentType","Options":{"Option":""},"Value":"0"},"policy-fire:Reason":{"@vpms-suffix":"Reason","Options":{"Option":""},"Value":"0  1"},"policy-fire:TotalPremium":{"@vpms-suffix":"TotalPremium","$":"4189.72"},"policy-fire:StampDuty":{"@vpms-suffix":"StampDuty","$":"16.75"},"policy-fire:TotalPayablePremium":{"@vpms-suffix":"TotalPayablePremium","$":"4206.47"}},"policy-fire:Coverage":{"@vpms-suffix":"Coverage","policy-fire:MainCoverage":{"@vpms-suffix":"MainCoverage","policy-fire:CoverageType":{"@vpms-suffix":"CoverageType","Options":{"Option":""},"Value":"CO"},"policy-fire:GoodCarriedByVehicle":{"@vpms-suffix":"GoodCarriedByVehicle","Options":{"Option":""},"Value":""},"policy-fire:CIType":{"@vpms-suffix":"CIType","Options":{"Option":""},"Value":"EMY3"},"policy-fire:GeographicLocation":{"@vpms-suffix":"GeographicLocation","Options":{"Option":""},"Value":"COCOA1"},"policy-fire:Region":{"@vpms-suffix":"Region","Options":{"Option":""},"Value":"W"},"policy-fire:Garage":{"@vpms-suffix":"Garage","Options":{"Option":""},"Value":"23"},"policy-fire:UseOfVehicle":{"@vpms-suffix":"UseOfVehicle","Options":{"Option":""},"Value":"VP"},"policy-fire:MarketValue":{"@vpms-suffix":"MarketValue"},"policy-fire:SumInsured":{"@vpms-suffix":"SumInsured","$":"100000"},"policy-fire:ExcessType":{"@vpms-suffix":"ExcessType","Options":{"Option":""},"Value":""},"policy-fire:ExcessAmt":{"@vpms-suffix":"ExcessAmt"}},"policy-fire:OptionalCoverages":{"@vpms-suffix":"OptionalCoverages","@counter":"0","policy-fire:OptionalCoverage":{"@vpms-suffix":"OptionalCoverage","policy-fire:AdditionalBenefitCode":{"@vpms-suffix":"AdditionalBenefitCode","Options":{"Option":""},"Value":""},"policy-fire:AdditionalPremiumClass":{"@vpms-suffix":"AdditionalPremiumClass","Options":{"Option":""},"Value":""},"policy-fire:AdditionalBenefitLimit":{"@vpms-suffix":"AdditionalBenefitLimit"},"policy-fire:AdditionalBenefitPremium":{"@vpms-suffix":"AdditionalBenefitPremium"}}}},"policy-fire:AnnualPremium":{"@vpms-suffix":"AnnualPremium","$":"1473.27"}},"policy-fire:VehicleInformation":{"@vpms-suffix":"VehicleInformation","motor:VehicleClass":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"VehicleClass","Options":{"Option":""},"Value":"CO"},"motor:VehicleNo":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"VehicleNo","$":"56X8-1509"},"motor:VehicleType":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"VehicleType","Options":{"Option":""},"Value":""},"motor:MakeOrModel":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"MakeOrModel","Options":{"Option":""},"Value":"BLJ01"},"motor:ModelDescription":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"ModelDescription"},"motor:ModelDescriptionAddition":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"ModelDescriptionAddition"},"motor:YearOfManufacture":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"YearOfManufacture","$":"2010"},"motor:EngineCapacity":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"EngineCapacity","$":"1500.00"},"motor:Body":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"Body","Options":{"Option":""},"Value":"CABRIO"},"motor:PowerBy":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"PowerBy","Options":{"Option":""},"Value":"D"},"motor:NoOfSeat":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"NoOfSeat","$":"5"},"motor:LogBookNo":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"LogBookNo","$":"Log2.1"},"motor:EngineMotorNo":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"EngineMotorNo","$":"ENG123"},"motor:ChassisNo":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"ChassisNo","$":"CHA123"},"motor:SafetyCode":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"SafetyCode","Options":{"Option":""},"Value":"07"},"motor:AntiThefCode":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"AntiThefCode","Options":{"Option":""},"Value":"02"},"motor:PermittedDriver":{"@xmlns:motor":"http://www.csc.com/integral/motor","@vpms-suffix":"PermittedDriver","Options":{"Option":""},"Value":"02"}},"policy-fire:FinancialInformation":{"@vpms-suffix":"FinancialInformation","policy-fire:OwnershipType":{"@vpms-suffix":"OwnershipType","Options":{"Option":""},"Value":""},"policy-fire:FinancialType":{"@vpms-suffix":"FinancialType","Options":{"Option":""},"Value":""},"policy-fire:LoanCompany":{"@vpms-suffix":"LoanCompany"},"policy-fire:VehiclePurchaseDate":{"@vpms-suffix":"VehiclePurchaseDate"},"policy-fire:PurchasePrice":{"@vpms-suffix":"PurchasePrice","$":"0.00"}},"policy-fire:MainDriver":{"@vpms-suffix":"MDPersonal","person:Photo":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDPhoto"},"person:Title":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDTitle","Options":{"Option":""},"Value":""},"person:PersonName":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDPersonName","person:FirstName":{"@vpms-suffix":"MDFirstName"},"person:MiddleName":{"@vpms-suffix":"MDMiddleName"},"person:LastName":{"@vpms-suffix":"MDLastName"},"person:AliasName":{"@vpms-suffix":"MDAliasName"},"person:FullName":{"@vpms-suffix":"MDFullName","$":"Tong Anh Eleven"}},"person:BirthDate":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDBirthDate","$":"1971-01-01"},"person:Gender":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDGender","Options":{"Option":""},"Value":"F"},"person:MaritalStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDMaritalStatus","Options":{"Option":""},"Value":""},"person:SmokerStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDSmokerStatus","Options":{"Option":""},"Value":""},"person:BusinessIndustry":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDBusinessIndustry","Options":{"Option":""},"Value":""},"person:Occupation":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDOccupation","Options":{"Option":""},"Value":"ACCT"},"person:ReferralType":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDReferralType","Options":{"Option":""},"Value":""},"person:Referrer":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDReferrer"},"person:Race":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDRace","Options":{"Option":""},"Value":""},"person:Nationality":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDNationality","Options":{"Option":""},"Value":""},"person:IDs":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDIDs","@counter":"1","person:ID":{"@vpms-suffix":"MDID","person:IDType":{"@vpms-suffix":"MDIDType","Options":{"Option":""},"Value":"PP"},"person:IDNumber":{"@vpms-suffix":"MDIDNumber","$":"S8978575H"}}},"person:Staff":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDStaff","Options":{"Option":""},"Value":""},"person:Vip":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDVip","Options":{"Option":""},"Value":""},"person:Education":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDEducation","Options":{"Option":""},"Value":""},"person:EmploymentStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDEmploymentStatus","Options":{"Option":""},"Value":""},"person:CountryOfBirth":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDCountryOfBirth","Options":{"Option":""},"Value":""},"person:Age":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDAge"},"person:Addresses":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDAddresses","@counter":"0","person:Address":{"@vpms-suffix":"MDAddress","person:AddressType":{"@vpms-suffix":"MDAddressType","Options":{"Option":""},"Value":""},"person:BlkHouseNo":{"@vpms-suffix":"MDBlkHouseNo"},"person:Street":{"@vpms-suffix":"MDStreet"},"person:UnitNo":{"@vpms-suffix":"MDUnitNo"},"person:Building":{"@vpms-suffix":"MDBuilding"},"person:City":{"@vpms-suffix":"MDCity"},"person:Country":{"@vpms-suffix":"MDCountry","Options":{"Option":""},"Value":""},"person:Postal":{"@vpms-suffix":"MDPostal"},"person:PreferredAddress":{"@vpms-suffix":"MDPreferredAddress","Options":{"Option":""},"Value":""}}},"person:Contacts":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"MDContacts","@counter":"0","person:Contact":{"@vpms-suffix":"MDContact","person:ContactType":{"@vpms-suffix":"MDContactType","Options":{"Option":""},"Value":""},"person:ContactInformation":{"@vpms-suffix":"MDContactInformation"},"person:PreferredContact":{"@vpms-suffix":"MDPreferredContact","Options":{"Option":""},"Value":""}}},"policy-fire:MDYearDrivingLicenceObtained":{"@vpms-suffix":"MDYearDrivingLicenceObtained","$":"2010"}},"policy-fire:OtherDrivers":{"@vpms-suffix":"OtherDrivers","@counter":"2","policy-fire:OtherDriver":[{"@vpms-suffix":"ODPersonal","person:Photo":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODPhoto"},"person:Title":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODTitle","Options":{"Option":""},"Value":""},"person:PersonName":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODPersonName","person:FirstName":{"@vpms-suffix":"ODFirstName"},"person:MiddleName":{"@vpms-suffix":"ODMiddleName"},"person:LastName":{"@vpms-suffix":"ODLastName"},"person:AliasName":{"@vpms-suffix":"ODAliasName"},"person:FullName":{"@vpms-suffix":"ODFullName","$":"Other Driver 1"}},"person:BirthDate":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODBirthDate","$":"1981-11-11"},"person:Gender":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODGender","Options":{"Option":""},"Value":"F"},"person:MaritalStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODMaritalStatus","Options":{"Option":""},"Value":""},"person:SmokerStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODSmokerStatus","Options":{"Option":""},"Value":""},"person:BusinessIndustry":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODBusinessIndustry","Options":{"Option":""},"Value":""},"person:Occupation":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODOccupation","Options":{"Option":""},"Value":"ACCT"},"person:ReferralType":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODReferralType","Options":{"Option":""},"Value":""},"person:Referrer":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODReferrer"},"person:Race":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODRace","Options":{"Option":""},"Value":""},"person:Nationality":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODNationality","Options":{"Option":""},"Value":""},"person:IDs":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODIDs","@counter":"1","person:ID":{"@vpms-suffix":"ODID","person:IDType":{"@vpms-suffix":"ODIDType","Options":{"Option":""},"Value":"PP"},"person:IDNumber":{"@vpms-suffix":"ODIDNumber","$":"312456"}}},"person:Staff":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODStaff","Options":{"Option":""},"Value":""},"person:Vip":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODVip","Options":{"Option":""},"Value":""},"person:Education":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODEducation","Options":{"Option":""},"Value":""},"person:EmploymentStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODEmploymentStatus","Options":{"Option":""},"Value":""},"person:CountryOfBirth":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODCountryOfBirth","Options":{"Option":""},"Value":""},"person:Age":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODAge"},"person:Addresses":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODAddresses","@counter":"0","person:Address":{"@vpms-suffix":"ODAddress","person:AddressType":{"@vpms-suffix":"ODAddressType","Options":{"Option":""},"Value":""},"person:BlkHouseNo":{"@vpms-suffix":"ODBlkHouseNo"},"person:Street":{"@vpms-suffix":"ODStreet"},"person:UnitNo":{"@vpms-suffix":"ODUnitNo"},"person:Building":{"@vpms-suffix":"ODBuilding"},"person:City":{"@vpms-suffix":"ODCity"},"person:Country":{"@vpms-suffix":"ODCountry","Options":{"Option":""},"Value":""},"person:Postal":{"@vpms-suffix":"ODPostal"},"person:PreferredAddress":{"@vpms-suffix":"ODPreferredAddress","Options":{"Option":""},"Value":""}}},"person:Contacts":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODContacts","@counter":"0","person:Contact":{"@vpms-suffix":"ODContact","person:ContactType":{"@vpms-suffix":"ODContactType","Options":{"Option":""},"Value":""},"person:ContactInformation":{"@vpms-suffix":"ODContactInformation"},"person:PreferredContact":{"@vpms-suffix":"ODPreferredContact","Options":{"Option":""},"Value":""}}},"policy-fire:ODYearDrivingLicenceObtained":{"@vpms-suffix":"ODYearDrivingLicenceObtained","$":"2010"}},{"@vpms-suffix":"ODPersonal","person:Photo":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODPhoto"},"person:Title":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODTitle","Options":{"Option":""},"Value":""},"person:PersonName":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODPersonName","person:FirstName":{"@vpms-suffix":"ODFirstName"},"person:MiddleName":{"@vpms-suffix":"ODMiddleName"},"person:LastName":{"@vpms-suffix":"ODLastName"},"person:AliasName":{"@vpms-suffix":"ODAliasName"},"person:FullName":{"@vpms-suffix":"ODFullName","$":"Other Driver 2"}},"person:BirthDate":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODBirthDate","$":"1971-11-11"},"person:Gender":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODGender","Options":{"Option":""},"Value":"M"},"person:MaritalStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODMaritalStatus","Options":{"Option":""},"Value":""},"person:SmokerStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODSmokerStatus","Options":{"Option":""},"Value":""},"person:BusinessIndustry":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODBusinessIndustry","Options":{"Option":""},"Value":""},"person:Occupation":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODOccupation","Options":{"Option":""},"Value":"ACTR"},"person:ReferralType":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODReferralType","Options":{"Option":""},"Value":""},"person:Referrer":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODReferrer"},"person:Race":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODRace","Options":{"Option":""},"Value":""},"person:Nationality":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODNationality","Options":{"Option":""},"Value":""},"person:IDs":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODIDs","@counter":"1","person:ID":{"@vpms-suffix":"ODID","person:IDType":{"@vpms-suffix":"ODIDType","Options":{"Option":""},"Value":"PP"},"person:IDNumber":{"@vpms-suffix":"ODIDNumber","$":"sdfsdfsd"}}},"person:Staff":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODStaff","Options":{"Option":""},"Value":""},"person:Vip":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODVip","Options":{"Option":""},"Value":""},"person:Education":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODEducation","Options":{"Option":""},"Value":""},"person:EmploymentStatus":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODEmploymentStatus","Options":{"Option":""},"Value":""},"person:CountryOfBirth":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODCountryOfBirth","Options":{"Option":""},"Value":""},"person:Age":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODAge"},"person:Addresses":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODAddresses","@counter":"0","person:Address":{"@vpms-suffix":"ODAddress","person:AddressType":{"@vpms-suffix":"ODAddressType","Options":{"Option":""},"Value":""},"person:BlkHouseNo":{"@vpms-suffix":"ODBlkHouseNo"},"person:Street":{"@vpms-suffix":"ODStreet"},"person:UnitNo":{"@vpms-suffix":"ODUnitNo"},"person:Building":{"@vpms-suffix":"ODBuilding"},"person:City":{"@vpms-suffix":"ODCity"},"person:Country":{"@vpms-suffix":"ODCountry","Options":{"Option":""},"Value":""},"person:Postal":{"@vpms-suffix":"ODPostal"},"person:PreferredAddress":{"@vpms-suffix":"ODPreferredAddress","Options":{"Option":""},"Value":""}}},"person:Contacts":{"@xmlns:person":"http://www.csc.com/integral/personal","@vpms-suffix":"ODContacts","@counter":"0","person:Contact":{"@vpms-suffix":"ODContact","person:ContactType":{"@vpms-suffix":"ODContactType","Options":{"Option":""},"Value":""},"person:ContactInformation":{"@vpms-suffix":"ODContactInformation"},"person:PreferredContact":{"@vpms-suffix":"ODPreferredContact","Options":{"Option":""},"Value":""}}},"policy-fire:ODYearDrivingLicenceObtained":{"@vpms-suffix":"ODYearDrivingLicenceObtained","$":"2011"}}]},"policy-fire:NCDSource":{"@vpms-suffix":"NCDSource","policy-fire:NCDFrom":{"@vpms-suffix":"NCDFrom","Options":{"Option":""},"Value":""},"policy-fire:NCDVehicleNo":{"@vpms-suffix":"NCDVehicleNo","$":"56X8-1509"},"policy-fire:PreviousPolicyNo":{"@vpms-suffix":"PreviousPolicyNo"},"policy-fire:PreviousPolicyEffectiveDate":{"@vpms-suffix":"PreviousPolicyEffectiveDate"},"policy-fire:PreviousPolicyExpiryDate":{"@vpms-suffix":"PreviousPolicyExpiryDate"},"policy-fire:NCDAllowed":{"@vpms-suffix":"NCDAllowed","Options":{"Option":""},"Value":"0"},"policy-fire:NCDEffectivedate":{"@vpms-suffix":"NCDEffectivedate"},"policy-fire:NoOfClaim":{"@vpms-suffix":"NoOfClaim"}},"policy-fire:Others":{"@vpms-suffix":"Others","policy-fire:InterestedParties":{"@vpms-suffix":"InterestedParties","@counter":"0","policy-fire:InterestedParty":{"@vpms-suffix":"InterestedParty","policy-fire:FullName":{"@vpms-suffix":"FullName"},"policy-fire:PartyType":{"@vpms-suffix":"PartyType","Options":{"Option":""},"Value":""},"policy-fire:Relationship":{"@vpms-suffix":"Relationship","Options":{"Option":""},"Value":""},"policy-fire:ClientNumber":{"@vpms-suffix":"ClientNumber"}}},"policy-fire:RiskClauses":{"@vpms-suffix":"RiskClauses","@counter":"0","policy-fire:RiskClause":{"@vpms-suffix":"RiskClause","policy-fire:Clause":{"@vpms-suffix":"Clause","Options":{"Option":""},"Value":""}}}}}}}};
				 self.detail = data;
			 }
			 deferred.resolve(data);						
		 });
		 return  deferred.promise;
	 };
	 
	 //Add function to get PaymentDue list
	 PolicyCoreService.prototype.loadPolicyPaymentDueList= function(resourceURL,policyId){
		 var self = this;
		 var deferred = self.$q.defer();
		 var url = commonService.getUrl(commonService.urlMap.GET_POLICY_DETAIL, [policyId]);		
		 self.ajax.getRuntime(resourceURL, url, function(data){
			 deferred.resolve(data);						
		 });
		 return  deferred.promise;
	 };
	 
	 
	 
	 PolicyCoreService.prototype.paymentDueList= function(resourceURL,user,type, range){
		 var self = this;
		 var deferred = self.$q.defer();
		 var url = "";
		 var dateNow =  moment(new Date()).format("YYYY-MM-DD");
//		 var dateNow =  "2015-01-01";
		 if(user == "Agent"){
			 type == "pnc" ? url = commonService.getUrl(commonService.urlMap.PNC_PAYMENTDUE_CURRENT_AGENT_V3,[dateNow, range]) : "";
			 type == "life"? url = commonService.getUrl(commonService.urlMap.LIFE_PAYMENTDUE_CURRENT_AGENT_V3, []) : "";
		 }else if (user == "Client"){
			 type == "pnc" ? url = commonService.getUrl(commonService.urlMap.PNC_PAYMENTDUE_CURRENT_CLIENT_V3,[dateNow, range]) : "";
			 type == "life"? url = commonService.getUrl(commonService.urlMap.LIFE_PAYMENTDUE_CURRENT_CLIENT_V3, []) : "";
		 }
		 if(url != ""){
			 self.ajax.getRuntime(resourceURL, url, function(data){
				 deferred.resolve(data);						
			 });
			 return  deferred.promise;
		 }		 
	 };
	 
	 PolicyCoreService.prototype.renewalList= function(resourceURL,user,type,range){
		 var self = this;
		 var deferred = self.$q.defer();
		 var url = "";
		 var dateNow =  moment(new Date()).format("DD/MM/YYYY");
		 if(user == "Agent"){
			 type == "vpm" ? url = commonService.getUrl(commonService.urlMap.PNC_RENEWAL_CURRENT_AGENT_V3,[dateNow, range, type]) : "";
			 type == "life"? url = commonService.getUrl(commonService.urlMap.LIFE_RENEWAL_CURRENT_AGENT_V3, [dateNow,range]) : "";
		 }else if (user == "Client"){
			 type == "vpm" ? url = commonService.getUrl(commonService.urlMap.PNC_RENEWAL_CURRENT_CLIENT_V3,[dateNow, range, type]) : "";
			 type == "life"? url = commonService.getUrl(commonService.urlMap.LIFE_RENEWAL_CURRENT_CLIENT_V3,[dateNow,range]) : "";
		 }
		 if(url != "" && range != undefined){
			 self.ajax.getRuntime(resourceURL, url, function(data){
				 deferred.resolve(data);						
			 });
			 return  deferred.promise;
		 }		 
	 };
	 
	 PolicyCoreService.prototype.loadListPolicyByAgentClient = function(resourceURL,clientId){
		 var self = this;
		 var deferred = self.$q.defer();
		 var url = commonService.getUrl(commonService.urlMap.SERVICE_FIND_POLICY_BY_AGENT_CLIENT_V3, [clientId]);		
		 self.ajax.getRuntime(resourceURL, url, function(data){
			 deferred.resolve(data);						
		 });
		 return  deferred.promise;
	 };
	 
	

	 
	 /*PolicyCoreService.prototype.refresh_V3 = function(resourceURL,productName){
		 var self = this;
		 var deferred = self.$q.defer();
		 var dataSet = self.detail;
		 var url = self.commonService.getUrl(self.commonService.urlMap.REFRESH, [self.name,productName]);
		 self.ajax.postRuntime(resourceURL,url, dataSet,function(data){//data = module detail			 
			 self.detail = data;
			 deferred.resolve(data);
				 if (bolValidate) {
					self.clearErrorInElement(self.detail);
					if(data["IposDocument"]){	//validate success
						 self.updateDetailData_V3(data);
					 } else{	//validate fail
						 self.mergeErrorToDetail(self.findJsonPathInItem(data, '$..ipos-error-document:ErrorGroup.ipos-error-document:Error'));
					 }
				 } else {
					 self.updateDetailData_V3(data);
				 }
		 });
		 return  deferred.promise;
	 };*/
	 
	
	return new PolicyCoreService($q, ajax, $location, appService, cacheService, detailCoreService, commonService, clientCoreService, translateService, $translate, salecaseUIService);
}]);
